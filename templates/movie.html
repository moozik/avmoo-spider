{% extends "main.html" %}
{% block title %}{{data.title}} - {% endblock %}
{% block container %}
<div class="container">
    <h3>{{data.title}}</h3>
    <div class="row movie">
        <div class="col-md-9 screencap">
            <a class="bigImage" href="{{cdn}}/digital/video{{data.bigimage}}" title="{{data.title}}">
                <img src="{{cdn}}/digital/video{{data.bigimage}}">
            </a>
        </div>
        <div class="col-md-3 info">
            <p>
                <span class="header">识别码:</span>
                <span class="like" data-type="av_id" data-val="{{data.av_id}}" style="color:#CC0000;">{{data.av_id}}</span>
            </p>
            {% if data.release_date %}
                <p>
                    <span class="header">发行时间:</span> {{data.release_date}}
                </p>
            {% endif %}
            {% if data.len %}
                <p>
                    <span class="header">长度:</span> {{data.len}}分钟
                </p>
            {% endif %}
            {% if data.director_url %}
                <p>
                    <span class="header">导演:</span>
                    <a data-type="director_url" data-val="{{data.director_url}}" href="/director/{{data.director_url}}">{{data.director}}</a>
                </p>
            {% endif %}
            {% if data.studio_url %}
                <p class="header">制作商: </p>
                <p>
                    <a data-type="studio_url" data-val="{{data.studio_url}}" href="/studio/{{data.studio_url}}">{{data.studio}}</a>
                </p>
            {% endif %}
            {% if data.label_url %}
                <p class="header">发行商: </p>
                <p>
                    <a data-type="label_url" data-val="{{data.label_url}}" href="/label/{{data.label_url}}">{{data.label}}</a>
                </p>
            {% endif %}
            {% if data.series_url %}
                <p class="header">系列:</p>
                <p>
                    <a data-type="series_url" data-val="{{data.series_url}}" href="/series/{{data.series_url}}">{{data.series}}</a>
                </p>
            {% endif %}
            {% if data.genre_list %}
            <p class="header">类别:</p>
            <p>
                 {% for item in data.genre_list %}
                    <span class="genre">
                        <a href="/genre/{{item}}">{{item}}</a>
                    </span>
                 {% endfor %}
            </p>
            {% endif %}
            <p>
                <a class="btn btn-default" href="{{avmoo_url}}/cn/movie/{{data.linkid}}" target="_blank">源站链接</a>
            </p>
        </div>
    </div>

    <div class="visible-xs-block pt-10 text-center">
        <div type="text/data-position" style="display:none" id="j_M_300x100-1">W3siaWQiOiJidHNfal9NXzMwMHgxMDAiLCJhZHNwb3QiOiJqX01fMzAweDEwMCIsIndlaWdodCI6IjEiLCJmY2FwIjpmYWxzZSwic2NoZWR1bGUiOmZhbHNlLCJtYXhXaWR0aCI6Ijc2OCIsIm1pbldpZHRoIjpmYWxzZSwidGltZXpvbmUiOmZhbHNlLCJleGNsdWRlIjpmYWxzZSwiZG9tYWluIjpmYWxzZSwiY29kZSI6IjxhIGhyZWY9XCJodHRwczpcL1wvYnRzby5wd1wvdmlkZW9cLyVFNSU4RCU5MSVFNyU4QyVBNSVFMyU4MSVBQSVFNSU4OCVCNiVFNiU5QyU4RCVFNiU4MCVBNyVFNCVCQSVBNCUyMCVFNiVCNSU4NSVFOSVBNiU5OSVFOCU5OCVBRFwiIHRhcmdldD1cIl9ibGFua1wiPjxpbWcgc3JjPVwiXC9hcHBcL2J0c1wvVmlld1wvaW1nXC9wMzAwMTAwLnBuZ1wiPjxcL2E+In0seyJpZCI6ImV4b2Nfal9NXzMwMHgxMDAiLCJhZHNwb3QiOiJqX01fMzAweDEwMCIsIndlaWdodCI6IjMiLCJmY2FwIjpmYWxzZSwic2NoZWR1bGUiOmZhbHNlLCJtYXhXaWR0aCI6Ijc2OCIsIm1pbldpZHRoIjpmYWxzZSwidGltZXpvbmUiOmZhbHNlLCJleGNsdWRlIjpmYWxzZSwiZG9tYWluIjpmYWxzZSwiY29kZSI6IjxzY3JpcHQ+XHJcbmFkX2lkem9uZSA9IFwiMTAyNjMxMFwiO1xyXG5hZF93aWR0aCA9IFwiMzAwXCI7XHJcbmFkX2hlaWdodCA9IFwiMTAwXCI7XHJcbmlmKHRvcD09PXNlbGYpIHZhciBwPWRvY3VtZW50LlVSTDsgZWxzZSB2YXIgcD1kb2N1bWVudC5yZWZlcnJlcjt2YXIgZHQ9bmV3IERhdGUoKS5nZXRUaW1lKCk7XHJcbnZhciBleG9Eb2N1bWVudFByb3RvY29sID0gKGRvY3VtZW50LmxvY2F0aW9uLnByb3RvY29sICE9IFwiaHR0cHM6XCIgJiYgZG9jdW1lbnQubG9jYXRpb24ucHJvdG9jb2wgIT0gXCJodHRwOlwiKSA/IFwiaHR0cHM6XCIgOiBkb2N1bWVudC5sb2NhdGlvbi5wcm90b2NvbDtcclxuaWYodHlwZW9mKGFkX3N1YikgPT0gJ3VuZGVmaW5lZCcpIHZhciBhZF9zdWIgPSBcIlwiO1xyXG5pZih0eXBlb2YoYWRfdGFncykgPT0gJ3VuZGVmaW5lZCcpIHZhciBhZF90YWdzID0gXCJcIjtcclxudmFyIGFkX3R5cGUgPSBhZF93aWR0aCArICd4JyArIGFkX2hlaWdodDtcclxuaWYoYWRfd2lkdGggPT0gJzEwMCUnICYmIGFkX2hlaWdodCA9PSAnMTAwJScpIGFkX3R5cGUgPSAnYXV0byc7XHJcbnZhciBhZF9zY3JlZW5fcmVzb2x1dGlvbiA9IHNjcmVlbi53aWR0aCArICd4JyArIHNjcmVlbi5oZWlnaHQ7XHJcbmRvY3VtZW50LndyaXRlKCc8aWZyYW1lIGZyYW1lYm9yZGVyPVwiMFwiIHNjcm9sbGluZz1cIm5vXCIgd2lkdGg9XCInICsgYWRfd2lkdGggKyAnXCIgaGVpZ2h0PVwiJyArIGFkX2hlaWdodCArICdcIiBzcmM9XCInICsgZXhvRG9jdW1lbnRQcm90b2NvbCArICdcL1wvc3luZGljYXRpb24uZXhvY2xpY2suY29tXC9hZHMtaWZyYW1lLWRpc3BsYXkucGhwP2lkem9uZT0nICsgYWRfaWR6b25lICsgJyZ0eXBlPScgKyBhZF90eXBlICsgJyZwPScgKyBlc2NhcGUocCkgKyAnJmR0PScgKyBkdCArICcmc3ViPScgKyBhZF9zdWIgKyAnJnRhZ3M9JyArIGFkX3RhZ3MgKyAnJnNjcmVlbl9yZXNvbHV0aW9uPScgKyBhZF9zY3JlZW5fcmVzb2x1dGlvbiArICdcIj48XC9pZnJhbWU+Jyk7XHJcbjxcL3NjcmlwdD4ifSx7ImlkIjoiamF2dV9qX01fMzAweDEwMCIsImFkc3BvdCI6ImpfTV8zMDB4MTAwIiwid2VpZ2h0IjoiMiIsImZjYXAiOmZhbHNlLCJzY2hlZHVsZSI6ZmFsc2UsIm1heFdpZHRoIjoiNzY4IiwibWluV2lkdGgiOmZhbHNlLCJ0aW1lem9uZSI6ZmFsc2UsImV4Y2x1ZGUiOmZhbHNlLCJkb21haW4iOmZhbHNlLCJjb2RlIjoiPGEgaHJlZj1cImh0dHBzOlwvXC9qYXZmZWUuY29tXCIgdGFyZ2V0PVwiX2JsYW5rXCI+PGltZyBzcmM9XCJcL2FwcFwvamF2dVwvVmlld1wvaW1nXC9iYW5uZXIuNjAweDEwMC5qcGdcIiB3aWR0aD1cIjMwMFwiIGhlaWdodD1cIjUwXCI+PFwvYT4ifSx7ImlkIjoianVpY19qX01fMzAweDEwMCIsImFkc3BvdCI6ImpfTV8zMDB4MTAwIiwid2VpZ2h0IjoiNSIsImZjYXAiOmZhbHNlLCJzY2hlZHVsZSI6ZmFsc2UsIm1heFdpZHRoIjoiNzY4IiwibWluV2lkdGgiOmZhbHNlLCJ0aW1lem9uZSI6ZmFsc2UsImV4Y2x1ZGUiOmZhbHNlLCJkb21haW4iOmZhbHNlLCJjb2RlIjoiPGlmcmFtZSBib3JkZXI9MCBmcmFtZWJvcmRlcj0wIG1hcmdpbmhlaWdodD0wIG1hcmdpbndpZHRoPTAgd2lkdGg9MzAwIGhlaWdodD0xMDAgc2Nyb2xsaW5nPW5vIGFsbG93dHJhbnNwYXJlbmN5PXRydWUgc3JjPVwvXC9hZHNlcnZlci5qdWljeWFkcy5jb21cL2Fkc2hvdy5waHA/YWR6b25lPTQ1MTczOT48XC9pZnJhbWU+In0seyJpZCI6Indhdl9qX01fMzAweDEwMCIsImFkc3BvdCI6ImpfTV8zMDB4MTAwIiwid2VpZ2h0IjoiMiIsImZjYXAiOmZhbHNlLCJzY2hlZHVsZSI6ZmFsc2UsIm1heFdpZHRoIjoiNzY4IiwibWluV2lkdGgiOmZhbHNlLCJ0aW1lem9uZSI6ZmFsc2UsImV4Y2x1ZGUiOmZhbHNlLCJkb21haW4iOmZhbHNlLCJjb2RlIjoiPGEgaHJlZj1cImh0dHBzOlwvXC9hdnhvLmNsdWJcL1wiIHRhcmdldD1cIl9ibGFua1wiPjxpbWcgc3JjPVwiXC9hcHBcL3dhdlwvVmlld1wvaW1nXC9iYW5uZXIuNjAweDEwMC5qcGdcIiB3aWR0aD1cIjMwMFwiIGhlaWdodD1cIjUwXCI+PFwvYT4ifV0=</div>
    </div>

    <style>
        .solink {
    width: 100px;
    height: 35px;
    line-height: 35px;
    text-align: center;
    font-size: 17px;
    display: block;
    background: #60727d;
    color: #fff;
    border-radius: 10px;
    margin-left: 10px;
    margin-top: 10px;
    bottom: 106px;
    float: left;
        }
    </style>
    <h4>搜索资源</h4>
    <div class="row">
        <a class="solink" href="https://btsow.rest/search/{{data.av_id}}" target="_blank">BTSO</a>
    </div>

    <h4>影片资源</h4>
    <div class="row">
        <input id="movie_resource" type="text" class="form-control" style="max-width: 400px;" placeholder="磁力链接 | 本地路径 | 在线地址" />
        <button class="btn btn-default insert-movie-local" type="submit">保存</button>
        <ul>
        {% for movie_resource in data.movie_resource_list %}
            <li><a href="{{movie_resource}}" target="_blank">{{movie_resource}}</a> <button class="btn btn-default delete-movie-local" data-val="{{movie_resource}}" type="submit">删除记录</button> <button class="btn btn-default execute-movie-local" data-val="{{movie_resource}}" type="submit">本地打开</button></li>
        {% endfor %}
        </ul>
    </div>

    {% if data.stars_data %}
    <h4>演员</h4>
    <h5>{{data.stars}}</h5>
    <div id="avatar-waterfall">
        {% for item in data.stars_data %}
        <a data-type="stars_url" data-val="{{item.linkid}}" class="avatar-box" href="/stars/{{item.linkid}}">
            <div class="photo-frame">
                {% if item.headimg %}
                <img src="{{cdn}}/{{item.headimg}}" title="">
                {% else %}
                <img src="{{cdn}}/mono/actjpgs/nowprinting.gif" title="">
                {% endif %}
            </div>
            <span>{{item.name}}</span>
        </a>
        {% endfor %}
    </div>
    {% endif %}

    <div class="clearfix"></div>
    {% if data.imglist %}
    <h4>样品图像</h4>
    <div id="sample-waterfall">
         {% for item in data.imglist %}
            <a class="sample-box" href="{{item.big}}" title="{{data.title}}">
                <div class="photo-frame">
                    <img src="{{item.small}}">
                </div>
            </a>
         {% endfor %}
    </div>
    {% endif %}
    <div class="clearfix"></div>

</div>
{% endblock %}

{% block pagination %}
{% endblock %}

{% block javascript %}
<script>
    $('.like').each(function () {
        $(this).after('<span title="收藏" class="glyphicon glyphicon-star-empty stars-btn" style="padding: 2px;color: #FFC107;"></span>');
    });
    $('.stars-btn').click(function(){
        var data_type = $($(this)[0].previousElementSibling).data('type');
        var data_val = $($(this)[0].previousElementSibling).data('val');
        $.get("/like/add/" + data_type + '/'+ data_val,function(data){
            $('#message_title').html(data);
            $('#message').modal('show');
        });
    });
    $('.insert-movie-local').click(function(){
        $.get("/action/extend/insert/movie_res/{{data.av_id}}/" + encodeURIComponent($('#movie_resource').val().replace(/\//g,'\\')),function(data){
            location.reload();
        });
    });
    $('.delete-movie-local').click(function(){
        $.get("/action/extend/delete/movie_res/{{data.av_id}}/" + encodeURIComponent($(this).data('val')),function(data){
            location.reload();
        });
    });
</script>
{% endblock %}